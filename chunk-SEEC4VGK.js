import{a as N}from"./chunk-SZQNQJVS.js";import"./chunk-V4F4V7VE.js";import{a as I}from"./chunk-I3RXV3E6.js";import"./chunk-ZMUGLBPJ.js";import"./chunk-KMKEUFOK.js";import{h as w,i as k,l as A}from"./chunk-J4EIBAYN.js";import{$ as v,Ba as C,Ea as a,Jb as U,Ra as M,V as p,Wa as f,_,fb as c,gb as e,hb as n,ib as u,la as g,mb as O,qb as S,rb as x,sb as P,vb as y,wb as r,xb as m,yb as E}from"./chunk-WYX5KYRP.js";import{a as b,b as h}from"./chunk-7CGTOI24.js";function F(o,i){if(o&1){let t=O();e(0,"tr")(1,"td",7),u(2,"img",8),e(3,"span"),r(4),n()(),e(5,"td")(6,"select",9),S("change",function(l){let d=_(t).$implicit,T=x(2);return v(T.updateRole(d,l.target.value))}),e(7,"option",10),r(8,"Usuario"),n(),e(9,"option",11),r(10,"Miembro"),n(),e(11,"option",12),r(12,"Staff"),n(),e(13,"option",13),r(14,"Admin"),n()()(),e(15,"td"),r(16),n(),e(17,"td")(18,"span",14),r(19),n()()()}if(o&2){let t=i.$implicit;a(2),c("src",t.photoURL||"assets/default-avatar.png",C),a(2),m(t.displayName),a(2),c("value",t.role),a(10),m(t.email),a(2),y(t.role),a(),m(t.role)}}function R(o,i){if(o&1&&(e(0,"div",5)(1,"table")(2,"thead")(3,"tr")(4,"th"),r(5,"Usuario"),n(),e(6,"th"),r(7,"Acciones"),n(),e(8,"th"),r(9,"Email"),n(),e(10,"th"),r(11,"Rol Actual"),n()()(),e(12,"tbody"),f(13,F,20,7,"tr",6),n()()()),o&2){let t=x();a(13),c("ngForOf",t.users())}}function D(o,i){o&1&&(e(0,"div",15),u(1,"div",16),e(2,"p"),r(3,"Cargando usuarios..."),n()())}var z=class o{authService=p(N);toastService=p(I);users=g([]);loading=g(!0);async ngOnInit(){await this.loadUsers()}async loadUsers(){this.loading.set(!0);try{let i=await this.authService.getAllUsers();this.users.set(i)}catch(i){console.error("Error loading users",i),this.toastService.error("Error al cargar usuarios")}finally{this.loading.set(!1)}}async updateRole(i,t){if(i.role!==t)try{let s=t;await this.authService.updateUserRole(i.uid,s),this.users.update(l=>l.map(d=>d.uid===i.uid?h(b({},d),{role:s}):d)),this.toastService.success(`Rol de ${i.displayName} actualizado a ${s}`)}catch(s){console.error("Error updating role",s),this.toastService.error("Error al actualizar rol")}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=M({type:o,selectors:[["app-admin-usuarios"]],decls:10,vars:3,consts:[["loader",""],[1,"admin-container"],[1,"header"],[1,"stats"],["class","table-container glass-effect",4,"ngIf","ngIfElse"],[1,"table-container","glass-effect"],[4,"ngFor","ngForOf"],[1,"user-cell"],["alt","Avatar","referrerpolicy","no-referrer",1,"avatar",3,"src"],[1,"role-select",3,"change","value"],["value","user"],["value","member"],["value","staff"],["value","admin"],[1,"badge"],[1,"loader-container"],[1,"spinner"]],template:function(t,s){if(t&1&&(e(0,"div",1)(1,"div",2)(2,"h1"),r(3,"Gesti\xF3n de Usuarios"),n(),e(4,"div",3)(5,"span"),r(6),n()()(),f(7,R,14,1,"div",4)(8,D,4,0,"ng-template",null,0,U),n()),t&2){let l=P(9);a(6),E("Total: ",s.users().length),a(),c("ngIf",!s.loading())("ngIfElse",l)}},dependencies:[A,w,k],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;padding-top:80px;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding-bottom:2rem}.admin-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}h1[_ngcontent-%COMP%]{color:#036;font-size:2.5rem;margin:0}.glass-effect[_ngcontent-%COMP%]{background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;padding:1rem;box-shadow:0 8px 32px #1f268726;border:1px solid rgba(255,255,255,.18);overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}th[_ngcontent-%COMP%]{font-weight:600;color:#666;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px}.user-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-weight:500;color:#333}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover;background:#eee}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.85rem;font-weight:600;text-transform:uppercase}.badge.user[_ngcontent-%COMP%]{background:#e0e0e0;color:#555}.badge.member[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.staff[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.badge.admin[_ngcontent-%COMP%]{background:#fce4ec;color:#c2185b}.role-select[_ngcontent-%COMP%]{padding:.5rem;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer;font-family:inherit;font-size:.9rem;color:#333;transition:all .2s}.role-select[_ngcontent-%COMP%]:hover{border-color:#036}.role-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#036;box-shadow:0 0 0 2px #0033661a}.loader-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem;color:#666}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #003366;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};export{z as AdminUsuariosComponent};
