import{h as R}from"./chunk-MYXBRZBT.js";import{a as T}from"./chunk-SPG2DMMT.js";import{j as I,k,n as N}from"./chunk-H6O6N7HE.js";import{Ea as y,Eb as x,Ha as l,Hb as A,Ib as o,Jb as g,Kb as b,Va as E,X as f,Yb as v,_a as p,a as h,aa as M,b as C,ba as S,jb as d,kb as t,lb as n,mb as _,na as u,qb as O,rb as P,sb as U,wb as w,xb as m}from"./chunk-ASF4LTZT.js";function $(r,i){if(r&1&&(O(0),_(1,"img",16),P()),r&2){let e=m().$implicit;l(),d("src",e.photoURL,y)}}function D(r,i){if(r&1&&(t(0,"div",17),o(1),n()),r&2){let e=m().$implicit;l(),b(" ",(e.displayName||"U").charAt(0)," ")}}function j(r,i){if(r&1){let e=U();t(0,"tr")(1,"td",8),p(2,$,2,1,"ng-container",9)(3,D,2,1,"ng-template",null,1,v),t(5,"span"),o(6),n()(),t(7,"td")(8,"select",10),w("change",function(s){let c=M(e).$implicit,F=m(2);return S(F.updateRole(c,s.target.value))}),t(9,"option",11),o(10,"Usuario"),n(),t(11,"option",12),o(12,"Miembro"),n(),t(13,"option",13),o(14,"Staff"),n(),t(15,"option",14),o(16,"Admin"),n()()(),t(17,"td"),o(18),n(),t(19,"td")(20,"span",15),o(21),n()()()}if(r&2){let e=i.$implicit,a=x(4);l(2),d("ngIf",e.photoURL)("ngIfElse",a),l(4),g(e.displayName),l(2),d("value",e.role),l(10),g(e.email),l(2),A(e.role),l(),g(e.role)}}function V(r,i){if(r&1&&(t(0,"div",6)(1,"table")(2,"thead")(3,"tr")(4,"th"),o(5,"Usuario"),n(),t(6,"th"),o(7,"Acciones"),n(),t(8,"th"),o(9,"Email"),n(),t(10,"th"),o(11,"Rol Actual"),n()()(),t(12,"tbody"),p(13,j,22,8,"tr",7),n()()()),r&2){let e=m();l(13),d("ngForOf",e.users())}}function L(r,i){r&1&&(t(0,"div",18),_(1,"div",19),t(2,"p"),o(3,"Cargando usuarios..."),n()())}var z=class r{authService=f(R);toastService=f(T);users=u([]);loading=u(!0);async ngOnInit(){await this.loadUsers()}async loadUsers(){this.loading.set(!0);try{let i=await this.authService.getAllUsers();this.users.set(i)}catch(i){console.error("Error loading users",i),this.toastService.error("Error al cargar usuarios")}finally{this.loading.set(!1)}}async updateRole(i,e){if(i.role!==e)try{let a=e;await this.authService.updateUserRole(i.id,a),this.users.update(s=>s.map(c=>c.uid===i.uid?C(h({},c),{role:a}):c)),this.toastService.success(`Rol de ${i.displayName} actualizado a ${a}`)}catch(a){console.error("Error updating role",a);let s="Error al actualizar rol";a.error&&a.error.message&&(s=a.error.message),this.toastService.error(s)}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-admin-usuarios"]],decls:10,vars:3,consts:[["loader",""],["defaultAvatar",""],[1,"admin-container"],[1,"header"],[1,"stats"],["class","table-container glass-effect",4,"ngIf","ngIfElse"],[1,"table-container","glass-effect"],[4,"ngFor","ngForOf"],[1,"user-cell"],[4,"ngIf","ngIfElse"],[1,"role-select",3,"change","value"],["value","user"],["value","member"],["value","staff"],["value","admin"],[1,"badge"],["alt","Avatar","referrerpolicy","no-referrer",1,"avatar",3,"src"],[1,"avatar","default-avatar-placeholder"],[1,"loader-container"],[1,"spinner"]],template:function(e,a){if(e&1&&(t(0,"div",2)(1,"div",3)(2,"h1"),o(3,"Gesti\xF3n de Usuarios"),n(),t(4,"div",4)(5,"span"),o(6),n()()(),p(7,V,14,1,"div",5)(8,L,4,0,"ng-template",null,0,v),n()),e&2){let s=x(9);l(6),b("Total: ",a.users().length),l(),d("ngIf",!a.loading())("ngIfElse",s)}},dependencies:[N,I,k],styles:["[_nghost-%COMP%]{display:block;min-height:100vh;padding-top:80px;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding-bottom:2rem}.admin-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}h1[_ngcontent-%COMP%]{color:#036;font-size:2.5rem;margin:0}.glass-effect[_ngcontent-%COMP%]{background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;padding:1rem;box-shadow:0 8px 32px #1f268726;border:1px solid rgba(255,255,255,.18);overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #eee}th[_ngcontent-%COMP%]{font-weight:600;color:#666;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px}.user-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;font-weight:500;color:#333}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover;background:#eee}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.85rem;font-weight:600;text-transform:uppercase}.badge.user[_ngcontent-%COMP%]{background:#e0e0e0;color:#555}.badge.member[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge.staff[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.badge.admin[_ngcontent-%COMP%]{background:#fce4ec;color:#c2185b}.role-select[_ngcontent-%COMP%]{padding:.5rem;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer;font-family:inherit;font-size:.9rem;color:#333;transition:all .2s}.role-select[_ngcontent-%COMP%]:hover{border-color:#036}.role-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#036;box-shadow:0 0 0 2px #0033661a}.loader-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem;color:#666}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #003366;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};export{z as AdminUsuariosComponent};
