import{a as fe}from"./chunk-37VHQXZU.js";import{a as ie,c as oe,e as re,g as ae,j as se,k as le,l as ce,m as de,o as me}from"./chunk-RJZUVJYA.js";import{h as pe}from"./chunk-MYXBRZBT.js";import{a as ne}from"./chunk-SPG2DMMT.js";import{a as ue}from"./chunk-RPL4CNPF.js";import{j as K,k as X,m as Z,n as ee,v as te,y as ge}from"./chunk-H6O6N7HE.js";import{$b as W,Fb as Y,Gb as C,Ha as s,Ib as r,Jb as S,Kb as x,Lb as V,Mb as O,Nb as P,Ob as E,Rb as q,S as A,Ub as J,Va as L,Wb as Q,X as k,_a as _,a as T,aa as m,b as F,ba as g,jb as u,kb as n,lb as o,mb as D,na as y,pa as H,sb as b,wb as p,xb as d}from"./chunk-ASF4LTZT.js";var R=class l{http=k(te);apiUrl=`${ge.apiUrl}/time-slots`;timeSlotsSignal=y([]);constructor(){this.fetchTimeSlots()}fetchTimeSlots(){this.http.get(this.apiUrl).subscribe({next:i=>this.timeSlotsSignal.set(i),error:i=>console.error("Error loading time slots:",i)})}getTimeSlots(){return this.timeSlotsSignal}addTimeSlot(i){return new Promise((e,a)=>{this.http.post(this.apiUrl,i).subscribe({next:t=>{this.timeSlotsSignal.update(c=>[...c,t]),e(t)},error:t=>a(t)})})}updateTimeSlot(i,e){return new Promise((a,t)=>{this.http.post(`${this.apiUrl}/${i}`,F(T({},e),{_method:"PUT"})).subscribe({next:c=>{this.timeSlotsSignal.update(v=>v.map(f=>f.id===i?c:f)),a(c)},error:c=>t(c)})})}deleteTimeSlot(i){return new Promise((e,a)=>{this.http.post(`${this.apiUrl}/${i}`,{_method:"DELETE"}).subscribe({next:()=>{this.timeSlotsSignal.update(t=>t.filter(c=>c.id!==i)),e()},error:t=>a(t)})})}static \u0275fac=function(e){return new(e||l)};static \u0275prov=A({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ce=()=>["admin","staff"];function Se(l,i){if(l&1){let e=b();n(0,"button",8),p("click",function(){m(e);let t=d();return g(t.openManageModal())}),r(1," \u2699\uFE0F Editar Horario "),o()}}function ke(l,i){if(l&1&&(n(0,"span",45),r(1),o()),l&2){let e=i.$implicit;s(),x(" \u{1F43E} ",e," ")}}function Me(l,i){if(l&1&&(n(0,"div",39)(1,"div",40),r(2),o(),n(3,"div",41)(4,"span",42),r(5),o(),n(6,"div",43),_(7,ke,2,1,"span",44),o()()()),l&2){let e=i.$implicit;s(2),x(" ",e.userName.charAt(0).toUpperCase()," "),s(3),S(e.userName),s(2),u("ngForOf",e.selectedDogs)}}function ye(l,i){if(l&1){let e=b();n(0,"div",31)(1,"button",32),p("click",function(){m(e);let t=d().$implicit,c=d(2);return g(c.toggleAttendees(t.id))}),n(2,"div",33)(3,"span",34),r(4,"group"),o(),n(5,"span"),r(6),o()(),n(7,"span",35),r(8,"expand_more"),o()(),n(9,"div",36)(10,"div",37),_(11,Me,8,3,"div",38),o()()()}if(l&2){let e=d().$implicit,a=d(2);s(),C("active",a.expandedSlots().has(e.id)),s(5),x("Ver asistentes (",e.reservations.length,")"),s(),C("open",a.expandedSlots().has(e.id)),s(2),C("expanded",a.expandedSlots().has(e.id)),s(2),u("ngForOf",e.reservations)}}function we(l,i){if(l&1){let e=b();n(0,"button",46),p("click",function(){m(e);let t=d().$implicit,c=d(2);return g(c.openCancelModal(t))}),r(1," Cancelar Reserva "),o()}}function Oe(l,i){if(l&1){let e=b();n(0,"button",47),p("click",function(){m(e);let t=d().$implicit,c=d(2);return g(c.bookSlot(t))}),r(1),o()}if(l&2){let e=d().$implicit;u("disabled",(e.currentBookings||0)>=e.max_bookings),s(),x(" ",(e.currentBookings||0)>=e.max_bookings?"Sin Plazas":"Reservar Plaza"," ")}}function Pe(l,i){if(l&1&&(n(0,"div",15)(1,"div",16)(2,"div",17)(3,"span",18),r(4,"schedule"),o(),r(5),o(),n(6,"div",19),D(7,"span",20),r(8),o()(),n(9,"div",21)(10,"div",22)(11,"span",23),r(12,"Ocupaci\xF3n"),o(),n(13,"strong",24),r(14),o()(),n(15,"div",25),D(16,"div",26),o()(),_(17,ye,12,8,"div",27),n(18,"div",28),_(19,we,2,0,"button",29)(20,Oe,2,2,"button",30),o()()),l&2){let e=i.$implicit;C("full",(e.currentBookings||0)>=e.max_bookings),s(5),V(" ",e.start_time," - ",e.end_time," "),s(),C("status-green",(e.currentBookings||0)/e.max_bookings<.5)("status-orange",(e.currentBookings||0)/e.max_bookings>=.5&&(e.currentBookings||0)<e.max_bookings)("status-red",(e.currentBookings||0)>=e.max_bookings),s(2),x(" ",(e.currentBookings||0)>=e.max_bookings?"Completo":"Disponible"," "),s(6),V("",e.currentBookings," / ",e.max_bookings),s(2),Y("width",(e.currentBookings||0)/e.max_bookings*100,"%"),C("fill-green",(e.currentBookings||0)/e.max_bookings<.5)("fill-orange",(e.currentBookings||0)/e.max_bookings>=.5&&(e.currentBookings||0)<e.max_bookings)("fill-red",(e.currentBookings||0)>=e.max_bookings),s(),u("ngIf",e.reservations&&e.reservations.length>0),s(2),u("ngIf",e.isBookedByCurrentUser),s(),u("ngIf",!e.isBookedByCurrentUser)}}function Ee(l,i){if(l&1&&(n(0,"div")(1,"div",9)(2,"h3",10),r(3),n(4,"span",11),r(5),J(6,"date"),o()(),n(7,"span",12),r(8),o()(),n(9,"div",13),_(10,Pe,21,24,"div",14),o()()),l&2){let e=i.$implicit;s(3),x(" ",e.day," "),s(2),S(Q(6,8,e.slots[0].date,"dd/MM")),s(2),C("morning",e.period==="Ma\xF1ana")("afternoon",e.period==="Tarde"),s(),x(" ",e.period," "),s(2),u("ngForOf",e.slots)}}function Te(l,i){if(l&1){let e=b();n(0,"div",58)(1,"p"),r(2,"\u26A0\uFE0F No tienes perros registrados."),o(),n(3,"a",59),p("click",function(){m(e);let t=d(2);return g(t.closeModal())}),r(4,"Ir a mi perfil para a\xF1adir uno"),o()()}}function Fe(l,i){if(l&1){let e=b();n(0,"label",60)(1,"input",61),p("change",function(){let t=m(e).$implicit,c=d(2);return g(c.toggleDogSelection(t.id))}),o(),n(2,"span",62),r(3),o()()}if(l&2){let e=i.$implicit,a=d(2);s(),u("checked",a.selectedDogIds.has(e.id)),s(2),x("\u{1F43E} ",e.name)}}function De(l,i){if(l&1){let e=b();n(0,"div",48),p("click",function(){m(e);let t=d();return g(t.closeModal())}),n(1,"div",49),p("click",function(t){return m(e),g(t.stopPropagation())}),n(2,"h3"),r(3,"\u{1F4C5} Confirmar Reserva"),o(),n(4,"p"),r(5,"\xBFQuieres reservar plaza para el "),n(6,"strong"),r(7),o(),r(8," a las "),n(9,"strong"),r(10),o(),r(11,"?"),o(),n(12,"div",50)(13,"p",51),r(14,"Selecciona los perretes que vendr\xE1n:"),o(),_(15,Te,5,0,"div",52),n(16,"div",53),_(17,Fe,4,2,"label",54),o()(),n(18,"div",55)(19,"button",56),p("click",function(){m(e);let t=d();return g(t.closeModal())}),r(20,"Cancelar"),o(),n(21,"button",57),p("click",function(){m(e);let t=d();return g(t.confirmBooking())}),r(22),o()()()()}if(l&2){let e=d();s(7),S(e.selectedSlotForBooking==null?null:e.selectedSlotForBooking.day),s(3),S(e.selectedSlotForBooking==null?null:e.selectedSlotForBooking.start_time),s(5),u("ngIf",e.myDogs().length===0),s(2),u("ngForOf",e.myDogs()),s(4),u("disabled",e.myDogs().length>0&&e.selectedDogIds.size===0||e.isSubmitting()),s(),x(" ",e.isSubmitting()?"Reservando...":"Confirmar Reserva"," ")}}function Ve(l,i){if(l&1){let e=b();n(0,"div",48),p("click",function(){m(e);let t=d();return g(t.closeCancelModal())}),n(1,"div",49),p("click",function(t){return m(e),g(t.stopPropagation())}),n(2,"h3"),r(3,"\u{1F622} Cancelar Reserva"),o(),n(4,"div",63)(5,"p",64),r(6,"\xBFEst\xE1s seguro de que quieres cancelar tu reserva para el "),n(7,"strong"),r(8),o(),r(9," a las "),n(10,"strong"),r(11),o(),r(12,"?"),o(),n(13,"p",65),r(14,"Esta acci\xF3n liberar\xE1 tu plaza inmediatamente."),o()(),n(15,"div",55)(16,"button",56),p("click",function(){m(e);let t=d();return g(t.closeCancelModal())}),r(17,"No, mantener"),o(),n(18,"button",66),p("click",function(){m(e);let t=d();return g(t.confirmCancellation())}),r(19),o()()()()}if(l&2){let e=d();s(8),S(e.selectedSlotForCancellation==null?null:e.selectedSlotForCancellation.day),s(3),S(e.selectedSlotForCancellation==null?null:e.selectedSlotForCancellation.start_time),s(7),u("disabled",e.isSubmitting()),s(),x(" ",e.isSubmitting()?"Cancelando...":"S\xED, cancelar reserva"," ")}}function Re(l,i){if(l&1){let e=b();n(0,"button",95),p("click",function(){m(e);let t=d(2);return t.editingSlot=null,g(t.slotForm={day:"Lunes",startTime:"10:00",endTime:"11:00",maxBookings:5})}),r(1," Cancelar Edici\xF3n "),o()}}function Ie(l,i){if(l&1){let e=b();n(0,"div",96)(1,"div",97)(2,"span",98),r(3),o(),n(4,"span",99),r(5),o()(),n(6,"div",100)(7,"span",101)(8,"span",102),r(9,"group"),o(),r(10),o()(),n(11,"div",103)(12,"button",104),p("click",function(){let t=m(e).$implicit,c=d(2);return g(c.editSlot(t))}),n(13,"span",70),r(14,"edit"),o()(),n(15,"button",105),p("click",function(){let t=m(e).$implicit,c=d(2);return g(c.deleteSlot(t.id))}),n(16,"span",70),r(17,"delete"),o()()()()}if(l&2){let e=i.$implicit;s(3),S(e.day.substring(0,3)),s(2),V("",e.start_time," - ",e.end_time),s(5),x(" ",e.max_bookings," plazas ")}}function Be(l,i){if(l&1){let e=b();n(0,"div",48),p("click",function(){m(e);let t=d();return g(t.closeManageModal())}),n(1,"div",67),p("click",function(t){return m(e),g(t.stopPropagation())}),n(2,"div",68)(3,"h3"),r(4,"\u2699\uFE0F Gesti\xF3n de Horarios"),o(),n(5,"button",69),p("click",function(){m(e);let t=d();return g(t.closeManageModal())}),n(6,"span",70),r(7,"close"),o()()(),n(8,"div",71)(9,"div",72)(10,"h4",73),r(11),o(),n(12,"div",74)(13,"div",75)(14,"label"),r(15,"D\xEDa de la semana"),o(),n(16,"div",76)(17,"select",77),E("ngModelChange",function(t){m(e);let c=d();return P(c.slotForm.day,t)||(c.slotForm.day=t),g(t)}),n(18,"option",78),r(19,"Lunes"),o(),n(20,"option",79),r(21,"Martes"),o(),n(22,"option",80),r(23,"Mi\xE9rcoles"),o(),n(24,"option",81),r(25,"Jueves"),o(),n(26,"option",82),r(27,"Viernes"),o(),n(28,"option",83),r(29,"S\xE1bado"),o(),n(30,"option",84),r(31,"Domingo"),o()(),n(32,"span",85),r(33,"expand_more"),o()()(),n(34,"div",75)(35,"label"),r(36,"Hora Inicio"),o(),n(37,"input",86),E("ngModelChange",function(t){m(e);let c=d();return P(c.slotForm.startTime,t)||(c.slotForm.startTime=t),g(t)}),o()(),n(38,"div",75)(39,"label"),r(40,"Hora Fin"),o(),n(41,"input",86),E("ngModelChange",function(t){m(e);let c=d();return P(c.slotForm.endTime,t)||(c.slotForm.endTime=t),g(t)}),o()(),n(42,"div",75)(43,"label"),r(44,"Plazas M\xE1x."),o(),n(45,"input",87),E("ngModelChange",function(t){m(e);let c=d();return P(c.slotForm.maxBookings,t)||(c.slotForm.maxBookings=t),g(t)}),o()()(),n(46,"div",88),_(47,Re,2,0,"button",89),n(48,"button",90),p("click",function(){m(e);let t=d();return g(t.saveSlot())}),r(49),o()()(),D(50,"div",91),n(51,"div",92)(52,"h4",73),r(53,"\u{1F4C5} Horarios Actuales"),o(),n(54,"div",93),_(55,Ie,18,4,"div",94),o()()()()()}if(l&2){let e=d();s(11),S(e.editingSlot?"\u270F\uFE0F Editar Horario":"\u2795 Nuevo Horario"),s(6),O("ngModel",e.slotForm.day),s(20),O("ngModel",e.slotForm.startTime),s(4),O("ngModel",e.slotForm.endTime),s(4),O("ngModel",e.slotForm.maxBookings),s(2),u("ngIf",e.editingSlot),s(2),x(" ",e.editingSlot?"Guardar Cambios":"A\xF1adir Horario"," "),s(6),u("ngForOf",e.timeSlots())}}var _e=class l{authService=k(pe);reservationService=k(ue);dogService=k(fe);timeSlotService=k(R);toastService=k(ne);isModalOpen=!1;isSubmitting=y(!1);selectedSlotForBooking=null;myDogs=this.dogService.getDogs();selectedDogIds=new Set;expandedSlots=y(new Set);selectedWeek=y("current");timeSlots=this.timeSlotService.getTimeSlots();isManageModalOpen=!1;editingSlot=null;slotForm={day:"Lunes",startTime:"10:00",endTime:"11:00",maxBookings:5};constructor(){H(()=>{this.authService.currentUserSignal()&&this.dogService.loadUserDogs()})}toggleWeek(i){this.selectedWeek.set(i),this.expandedSlots.set(new Set)}getDatesForWeek(i){let e={},a=["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"],t=new Date,c=t.getDay()||7;t.setDate(t.getDate()-c+1+i*7),t.setHours(0,0,0,0);for(let v=0;v<7;v++){let f=new Date(t);f.setDate(t.getDate()+v);let I=f.getFullYear(),B=String(f.getMonth()+1).padStart(2,"0"),G=String(f.getDate()).padStart(2,"0");e[a[v]]=`${I}-${B}-${G}`}return e}slots=W(()=>{let i=this.reservationService.getReservations()(),e=this.reservationService.getAvailability()(),a=this.authService.currentUserSignal(),c=this.selectedWeek()==="current"?0:1,v=this.getDatesForWeek(c),f=new Date,I=f.getFullYear(),B=String(f.getMonth()+1).padStart(2,"0"),G=String(f.getDate()).padStart(2,"0"),xe=`${I}-${B}-${G}`;return this.timeSlots().map(M=>{let z=v[M.day],j=i.filter(h=>{let $=h.slotId==M.id,ve=h.date===z;return $&&ve}),w=e.find(h=>h.slot_id===M.id&&h.date===z),be=w?w.count:0,U=[];w&&w.attendees?U=w.attendees.map(h=>({userName:h.user_name,selectedDogs:h.dogs})):U=j;let N=a?j.find(h=>String(h.userId)===String(a.id)):void 0;return F(T({},M),{date:z,currentBookings:be,isBookedByCurrentUser:!!N,userReservationId:N?.id,reservations:U})}).filter(M=>M.date>=xe)});groupedSlots=W(()=>{let i=this.slots();return["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes"].map(a=>{let t=i.filter(f=>f.day===a);if(t.length===0)return null;let v=parseInt(t[0].start_time.split(":")[0])<16?"Ma\xF1ana":"Tarde";return{day:a,period:v,slots:t}}).filter(a=>a!==null)});openManageModal(){this.isManageModalOpen=!0,this.editingSlot=null,this.slotForm={day:"Lunes",startTime:"10:00",endTime:"11:00",maxBookings:5}}editSlot(i){this.isManageModalOpen=!0,this.editingSlot=i,this.slotForm={day:i.day,startTime:i.start_time,endTime:i.end_time,maxBookings:i.max_bookings}}closeManageModal(){this.isManageModalOpen=!1,this.editingSlot=null}async deleteSlot(i){if(confirm("\xBFEst\xE1s seguro de eliminar este horario? Se perder\xE1n las reservas asociadas."))try{await this.timeSlotService.deleteTimeSlot(i),this.timeSlotService.fetchTimeSlots(),this.toastService.success("Horario eliminado.")}catch(e){console.error(e),this.toastService.error("Error al eliminar.")}}async saveSlot(){try{let i={day:this.slotForm.day,start_time:this.slotForm.startTime,end_time:this.slotForm.endTime,max_bookings:this.slotForm.maxBookings};this.editingSlot?(await this.timeSlotService.updateTimeSlot(this.editingSlot.id,i),this.toastService.success("Horario actualizado.")):(await this.timeSlotService.addTimeSlot(i),this.toastService.success("Horario creado.")),this.timeSlotService.fetchTimeSlots(),this.closeManageModal()}catch(i){console.error(i),this.toastService.error("Error al guardar.")}}bookSlot(i){if(!this.authService.currentUserSignal()){this.toastService.warning("Debes iniciar sesi\xF3n para reservar.");return}if(i.currentBookings>=i.max_bookings){this.toastService.error("Esta clase est\xE1 completa.");return}if(i.isBookedByCurrentUser){this.toastService.info("Ya tienes una reserva en este horario.");return}this.selectedSlotForBooking=i,this.selectedDogIds.clear(),this.isSubmitting.set(!1),this.isModalOpen=!0}toggleAttendees(i){let e=new Set(this.expandedSlots());e.has(i)?e.delete(i):e.add(i),this.expandedSlots.set(e)}toggleDogSelection(i){let e=new Set(this.selectedDogIds);e.has(i)?e.delete(i):e.add(i),this.selectedDogIds=e}closeModal(){this.isModalOpen=!1,this.selectedSlotForBooking=null,this.isSubmitting.set(!1)}async confirmBooking(){if(!this.selectedSlotForBooking||this.isSubmitting())return;if(this.selectedDogIds.size===0){this.toastService.warning("Por favor, selecciona al menos un perro.");return}let i=this.authService.currentUserSignal();if(!i)return;let e=i.name||"Usuario",a=this.slots().find(t=>t.id===this.selectedSlotForBooking.id);if(a){let t=this.selectedDogIds.size;if(a.currentBookings+t>a.max_bookings){let c=a.max_bookings-a.currentBookings;this.toastService.error(`No hay suficientes plazas. Intentas reservar para ${t} perro(s) pero solo quedan ${c} plazas.`);return}}this.isSubmitting.set(!0);try{let t=Array.from(this.selectedDogIds);await this.reservationService.addReservation({slotId:this.selectedSlotForBooking.id,userId:i.id,date:this.selectedSlotForBooking.date,dogIds:t}),this.closeModal(),this.toastService.success("\xA1Reserva confirmada con \xE9xito!")}catch(t){console.error("Error al reservar:",t),t.error&&t.error.message?this.toastService.error(t.error.message):this.toastService.error("Hubo un error al realizar la reserva."),this.isSubmitting.set(!1)}}isCancelModalOpen=!1;selectedSlotForCancellation=null;openCancelModal(i){i.isBookedByCurrentUser&&(this.selectedSlotForCancellation=i,this.isCancelModalOpen=!0)}closeCancelModal(){this.isCancelModalOpen=!1,this.selectedSlotForCancellation=null}async confirmCancellation(){if(this.selectedSlotForCancellation){this.isSubmitting.set(!0);try{await this.reservationService.deleteBlock(this.selectedSlotForCancellation.id,this.selectedSlotForCancellation.date),this.toastService.success("Reserva cancelada correctamente."),this.closeCancelModal()}catch(i){console.error(i),this.toastService.error("Error al cancelar.")}finally{this.isSubmitting.set(!1)}}}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=L({type:l,selectors:[["app-gestionar-reservas"]],decls:17,vars:10,consts:[[1,"reservations-container"],[1,"header-main"],[1,"subtitle"],["class","btn-edit-schedule",3,"click",4,"ngIf"],[1,"week-selector"],[3,"click"],[4,"ngFor","ngForOf"],["class","modal-backdrop",3,"click",4,"ngIf"],[1,"btn-edit-schedule",3,"click"],[1,"header-container"],[1,"day-header"],[1,"date-label"],[1,"period-badge"],[1,"slots-grid"],["class","slot-card",3,"full",4,"ngFor","ngForOf"],[1,"slot-card"],[1,"card-header"],[1,"time-badge"],[1,"material-icons","time-icon"],[1,"status-indicator"],[1,"status-dot"],[1,"availability-section"],[1,"progress-labels"],[1,"label"],[1,"count"],[1,"progress-track"],[1,"progress-fill"],["class","attendees-section",4,"ngIf"],[1,"actions"],["class","btn-action btn-cancel-card",3,"click",4,"ngIf"],["class","btn-action btn-book",3,"disabled","click",4,"ngIf"],[1,"attendees-section"],[1,"toggle-attendees-btn",3,"click"],[1,"btn-content"],[1,"material-icons","group-icon"],[1,"material-icons","chevron"],[1,"attendees-list-wrapper"],[1,"attendees-list"],["class","attendee-card",4,"ngFor","ngForOf"],[1,"attendee-card"],[1,"attendee-avatar"],[1,"attendee-info"],[1,"attendee-name"],[1,"attendee-dogs"],["class","dog-tag",4,"ngFor","ngForOf"],[1,"dog-tag"],[1,"btn-action","btn-cancel-card",3,"click"],[1,"btn-action","btn-book",3,"click","disabled"],[1,"modal-backdrop",3,"click"],[1,"modal-content",3,"click"],[1,"dog-selection"],[2,"margin","0 0 1rem 0","font-weight","600","color","#555"],["class","no-dogs-warning",4,"ngIf"],[1,"dog-checkboxes"],["class","dog-checkbox",4,"ngFor","ngForOf"],[1,"modal-actions"],[1,"btn-secondary",3,"click"],[1,"btn-confirm",3,"click","disabled"],[1,"no-dogs-warning"],["routerLink","/perfil",3,"click"],[1,"dog-checkbox"],["type","checkbox",3,"change","checked"],[1,"dog-label"],[1,"modal-body"],[1,"confirm-message"],[1,"note","warning"],[1,"btn-confirm","btn-delete-action",3,"click","disabled"],[1,"modal-content","large-modal",3,"click"],[1,"modal-header"],[1,"btn-icon","close-btn",3,"click"],[1,"material-icons"],[1,"management-body"],[1,"management-form-card"],[1,"section-title"],[1,"form-grid"],[1,"form-group"],[1,"select-wrapper"],[3,"ngModelChange","ngModel"],["value","Lunes"],["value","Martes"],["value","Mi\xE9rcoles"],["value","Jueves"],["value","Viernes"],["value","S\xE1bado"],["value","Domingo"],[1,"material-icons","select-icon"],["type","time",1,"modern-input",3,"ngModelChange","ngModel"],["type","number","min","1",1,"modern-input",3,"ngModelChange","ngModel"],[1,"form-actions-row"],["class","btn-text",3,"click",4,"ngIf"],[1,"btn-primary-action",3,"click"],[1,"divider"],[1,"slots-list-section"],[1,"slots-list-container"],["class","admin-slot-card",4,"ngFor","ngForOf"],[1,"btn-text",3,"click"],[1,"admin-slot-card"],[1,"slot-info-main"],[1,"day-badge"],[1,"time-range"],[1,"slot-details"],[1,"capacity-badge"],[1,"material-icons","icon-tiny"],[1,"slot-actions"],["title","Editar",1,"btn-icon-action","edit",3,"click"],["title","Eliminar",1,"btn-icon-action","delete",3,"click"]],template:function(e,a){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),r(4,"Gestionar Reservas"),o(),n(5,"p",2),r(6,"Selecciona una franja horaria para reservar tu clase de Agility."),o()(),_(7,Se,2,0,"button",3),o(),n(8,"div",4)(9,"button",5),p("click",function(){return a.toggleWeek("current")}),r(10," Semana Actual "),o(),n(11,"button",5),p("click",function(){return a.toggleWeek("next")}),r(12," Semana Siguiente "),o()(),_(13,Ee,11,11,"div",6),o(),_(14,De,23,6,"div",7)(15,Ve,20,4,"div",7)(16,Be,56,8,"div",7)),e&2){let t;s(7),u("ngIf",q(9,Ce).includes(((t=a.authService.currentUserSignal())==null?null:t.role)||"")),s(2),C("active",a.selectedWeek()==="current"),s(2),C("active",a.selectedWeek()==="next"),s(2),u("ngForOf",a.groupedSlots()),s(),u("ngIf",a.isModalOpen),s(),u("ngIf",a.isCancelModalOpen),s(),u("ngIf",a.isManageModalOpen)}},dependencies:[ee,K,X,me,le,ce,ie,ae,se,oe,de,re,Z],styles:[".reservations-container[_ngcontent-%COMP%]{max-width:1100px;margin:2rem auto;padding:2rem 1rem;animation:_ngcontent-%COMP%_fadeIn .6s cubic-bezier(.2,.8,.2,1)}.header-main[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}h2[_ngcontent-%COMP%]{color:var(--text-main);font-size:2.2rem;margin-bottom:.5rem;font-weight:800;letter-spacing:-1px}.subtitle[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:1.1rem;margin:0}.btn-edit-schedule[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;padding:10px 20px;border-radius:50px;font-weight:600;color:var(--text-secondary);cursor:pointer;transition:all .2s;box-shadow:var(--shadow-sm);display:flex;align-items:center;gap:8px}.btn-edit-schedule[_ngcontent-%COMP%]:hover{border-color:var(--primary-blue);color:var(--primary-blue);transform:translateY(-2px);box-shadow:var(--shadow-md)}.week-selector[_ngcontent-%COMP%]{display:flex;justify-content:center;background:#fff;padding:6px;border-radius:50px;width:fit-content;margin:0 auto 3rem;box-shadow:0 4px 20px #0000000f;border:1px solid #f0f0f0}.week-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;padding:10px 32px;border-radius:40px;cursor:pointer;font-weight:600;color:var(--text-secondary);transition:all .3s cubic-bezier(.25,.8,.25,1);font-size:.95rem}.week-selector[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary-blue);color:#fff;box-shadow:0 4px 12px #0073cf4d}.week-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(.active){background:#f8fafc;color:var(--primary-blue)}.header-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:3rem 0 1.5rem;padding-bottom:1rem;border-bottom:2px solid #f1f5f9}.day-header[_ngcontent-%COMP%]{margin:0;color:var(--text-main);font-size:1.5rem;font-weight:800;display:flex;align-items:center;gap:12px}.date-label[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-light);font-weight:600;background:#f1f5f9;padding:4px 10px;border-radius:8px}.period-badge[_ngcontent-%COMP%]{padding:6px 14px;border-radius:50px;font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px}.period-badge.morning[_ngcontent-%COMP%]{background-color:#fff7ed;color:#ea580c;border:1px solid #ffedd5}.period-badge.afternoon[_ngcontent-%COMP%]{background-color:#eff6ff;color:#2563eb;border:1px solid #dbeafe}.slots-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem;margin-bottom:2rem}.slot-card[_ngcontent-%COMP%]{background:var(--white);border-radius:20px;padding:1.5rem;border:1px solid #f1f5f9;box-shadow:0 4px 6px -1px #0000000d,0 2px 4px -1px #00000008;transition:all .3s ease;display:flex;flex-direction:column;gap:1.25rem;position:relative;overflow:hidden}.slot-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.slot-card.full[_ngcontent-%COMP%]{background:snow;border-color:#fee2e2}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.time-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:1.1rem;font-weight:700;color:var(--text-main);background:#f8fafc;padding:6px 12px;border-radius:12px}.time-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--text-light)}.status-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.8rem;font-weight:600;padding:4px 10px;border-radius:20px}.status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%}.status-green[_ngcontent-%COMP%]{color:#059669;background:#ecfdf5}.status-green[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:#059669}.status-orange[_ngcontent-%COMP%]{color:#d97706;background:#fffbeb}.status-orange[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:#d97706}.status-red[_ngcontent-%COMP%]{color:#dc2626;background:#fef2f2}.status-red[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:#dc2626}.availability-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.progress-labels[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.85rem;color:var(--text-secondary)}.progress-track[_ngcontent-%COMP%]{height:8px;background:#f1f5f9;border-radius:4px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;border-radius:4px;transition:width .5s cubic-bezier(.4,0,.2,1)}.fill-green[_ngcontent-%COMP%]{background:linear-gradient(90deg,#34d399,#10b981)}.fill-orange[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fcd34d,#f59e0b)}.fill-red[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fca5a5,#ef4444)}.attendees-section[_ngcontent-%COMP%]{border-top:1px solid #f1f5f9;padding-top:1rem;margin-top:auto}.toggle-attendees-btn[_ngcontent-%COMP%]{width:100%;background:transparent;border:none;padding:0;display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:.9rem;color:var(--text-secondary);transition:color .2s;font-weight:500}.btn-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.group-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--text-light)}.toggle-attendees-btn[_ngcontent-%COMP%]:hover, .toggle-attendees-btn.active[_ngcontent-%COMP%], .toggle-attendees-btn[_ngcontent-%COMP%]:hover   .group-icon[_ngcontent-%COMP%], .toggle-attendees-btn.active[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{color:var(--primary-blue)}.chevron[_ngcontent-%COMP%]{transition:transform .3s ease;font-size:20px}.chevron.open[_ngcontent-%COMP%]{transform:rotate(180deg)}.attendees-list-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-rows:0fr;transition:grid-template-rows .3s ease-out}.attendees-list-wrapper.expanded[_ngcontent-%COMP%]{grid-template-rows:1fr;margin-top:1rem}.attendees-list[_ngcontent-%COMP%]{overflow:hidden;display:flex;flex-direction:column;gap:10px}.attendee-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:#f8fafc;padding:10px;border-radius:12px;border:1px solid #e2e8f0}.attendee-avatar[_ngcontent-%COMP%]{width:36px;height:36px;background:linear-gradient(135deg,var(--primary-blue) 0%,#005bb5 100%);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.9rem;flex-shrink:0}.attendee-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.attendee-name[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:var(--text-main)}.attendee-dogs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.dog-tag[_ngcontent-%COMP%]{font-size:.75rem;background:#fff;padding:2px 8px;border-radius:8px;border:1px solid #e2e8f0;color:var(--text-secondary)}.actions[_ngcontent-%COMP%]{margin-top:1rem}.btn-action[_ngcontent-%COMP%]{width:100%;padding:12px;border:none;border-radius:12px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .2s;display:flex;justify-content:center;align-items:center}.btn-book[_ngcontent-%COMP%]{background:var(--primary-blue);color:#fff;box-shadow:0 4px 6px #0073cf33}.btn-book[_ngcontent-%COMP%]:hover:not([disabled]){transform:translateY(-2px);box-shadow:0 6px 12px #0073cf4d;background:#0062b3}.btn-book[_ngcontent-%COMP%]:disabled{background:#e2e8f0;color:#94a3b8;cursor:not-allowed;box-shadow:none}.btn-cancel-card[_ngcontent-%COMP%]{background:#fff;border:2px solid #fecaca;color:#dc2626}.btn-cancel-card[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#ef4444}.btn-secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#666;border:none;padding:.8rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;transition:background .2s}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.btn-delete-action[_ngcontent-%COMP%]{background:#dc3545;color:#fff;box-shadow:0 4px 10px #dc35454d}.btn-delete-action[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:translateY(-2px);box-shadow:0 6px 15px #dc354566}.large-modal[_ngcontent-%COMP%]{max-width:700px;width:95%;max-height:90vh;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 2rem;background:#f8fafc;border-bottom:1px solid #e2e8f0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;border:none;padding:0;background:transparent}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--text-light);cursor:pointer;padding:8px;border-radius:50%;transition:all .2s;display:flex;justify-content:center;align-items:center}.close-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:var(--text-main)}.management-body[_ngcontent-%COMP%]{padding:2rem;overflow-y:auto;flex:1}.section-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:var(--text-main);margin-bottom:1.5rem;margin-top:0}.management-form-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1.5rem;margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:var(--text-secondary)}.modern-input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #e2e8f0;border-radius:8px;font-size:.95rem;color:var(--text-main);transition:all .2s;background:#f8fafc;width:100%}.modern-input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-blue);background:#fff;box-shadow:0 0 0 3px #0073cf1a}.select-wrapper[_ngcontent-%COMP%]{position:relative}.select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{appearance:none;padding-right:30px}.select-icon[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);pointer-events:none;color:var(--text-light);font-size:20px}.form-actions-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;align-items:center}.btn-primary-action[_ngcontent-%COMP%]{background:var(--primary-blue);color:#fff;border:none;padding:10px 24px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;box-shadow:0 4px 10px #0073cf33}.btn-primary-action[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 6px 15px #0073cf4d;background:#005bb5}.btn-text[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--text-light);cursor:pointer;font-weight:500}.btn-text[_ngcontent-%COMP%]:hover{color:var(--text-main);text-decoration:underline}.divider[_ngcontent-%COMP%]{height:1px;background:#f1f5f9;margin:2rem 0}.slots-list-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem}.admin-slot-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:1rem;background:#fff;border:1px solid #e2e8f0;border-radius:12px;transition:all .2s}.admin-slot-card[_ngcontent-%COMP%]:hover{border-color:var(--primary-blue);box-shadow:0 4px 12px #0000000d}.slot-info-main[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;margin-bottom:8px}.day-badge[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;font-weight:700;letter-spacing:.5px;color:var(--primary-blue)}.time-range[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--text-main)}.slot-details[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:12px}.capacity-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.85rem;color:var(--text-secondary);background:#f1f5f9;padding:4px 8px;border-radius:6px}.icon-tiny[_ngcontent-%COMP%]{font-size:14px}.slot-actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.btn-icon-action[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.btn-icon-action[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}.btn-icon-action.edit[_ngcontent-%COMP%]{background:#eff6ff;color:var(--primary-blue)}.btn-icon-action.edit[_ngcontent-%COMP%]:hover{background:#dbeafe}.btn-icon-action.delete[_ngcontent-%COMP%]{background:#fef2f2;color:#ef4444}.btn-icon-action.delete[_ngcontent-%COMP%]:hover{background:#fee2e2}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0006;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;justify-content:center;align-items:center;z-index:2000;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:0;border-radius:24px;width:90%;max-width:480px;box-shadow:0 25px 50px -12px #00000040;overflow:hidden;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.2,.8,.2,1)}.modal-body[_ngcontent-%COMP%]{padding:2rem;display:flex;flex-direction:column;gap:1.5rem}.confirm-message[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.6;color:var(--text-main);margin:0;padding:0 .5rem}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;padding:1.5rem 2rem;background:#f8fafc;font-size:1.25rem;font-weight:700;border-bottom:1px solid #e2e8f0}.dog-selection[_ngcontent-%COMP%]{padding:1.5rem}.dog-checkboxes[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:12px}.dog-checkbox[_ngcontent-%COMP%]{position:relative;cursor:pointer}.dog-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0}.dog-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px;background:#fff;border:2px solid #e2e8f0;border-radius:12px;font-weight:600;color:var(--text-secondary);transition:all .2s}.dog-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .dog-label[_ngcontent-%COMP%]{border-color:var(--primary-blue);background:#eff6ff;color:var(--primary-blue);box-shadow:0 4px 6px #0073cf1a}.modal-actions[_ngcontent-%COMP%]{padding:1.5rem 2rem;background:#f8fafc;border-top:1px solid #e2e8f0;display:flex;gap:12px;justify-content:flex-end}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}@media(max-width:600px){.reservations-container[_ngcontent-%COMP%]{padding:1rem}.header-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.slots-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.dog-checkbox[_ngcontent-%COMP%]:has(input:checked){background-color:var(--primary-blue);color:#fff}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}.btn-cancel[_ngcontent-%COMP%]{background:none;border:1px solid #ddd;padding:8px 16px;border-radius:6px;cursor:pointer}.btn-confirm[_ngcontent-%COMP%]{background-color:var(--primary-blue);color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-weight:700}.btn-confirm[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.no-dogs-warning[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404;padding:10px;border-radius:6px;font-size:.9rem;margin-bottom:10px}.no-dogs-warning[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#856404;text-decoration:underline}"]})};export{_e as GestionarReservasComponent};
