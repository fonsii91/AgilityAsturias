import{v as d,y as u}from"./chunk-H6O6N7HE.js";import{S as h,X as l,a as s,b as c,na as f}from"./chunk-ASF4LTZT.js";var g=class a{http=l(d);apiUrl=`${u.apiUrl}/competitions`;competitionsSignal=f([]);constructor(){this.fetchCompetitions()}fetchCompetitions(){this.http.get(this.apiUrl).subscribe({next:t=>{let e=t.map(o=>this.mapFromBackend(o));this.competitionsSignal.set(e)},error:t=>console.error("Error loading competitions:",t)})}getCompetitions(){return this.competitionsSignal}addCompetition(t){let e=this.mapToBackend(t);return new Promise((o,n)=>{this.http.post(this.apiUrl,e).subscribe({next:i=>{let r=this.mapFromBackend(i);this.competitionsSignal.update(p=>[...p,r]),o(r)},error:i=>n(i)})})}updateCompetition(t){let e=this.mapToBackend(t);return new Promise((o,n)=>{this.http.post(`${this.apiUrl}/${t.id}`,c(s({},e),{_method:"PUT"})).subscribe({next:i=>{let r=this.mapFromBackend(i);this.competitionsSignal.update(p=>p.map(m=>m.id===r.id?r:m)),o(r)},error:i=>n(i)})})}deleteCompetition(t){return new Promise((e,o)=>{this.http.post(`${this.apiUrl}/${t}`,{_method:"DELETE"}).subscribe({next:()=>{this.competitionsSignal.update(n=>n.filter(i=>i.id!==t)),e()},error:n=>o(n)})})}mapToBackend(t){return{nombre:t.nombre,lugar:t.lugar,fecha_evento:t.fechaEvento,fecha_fin_evento:t.fechaFinEvento,fecha_limite:t.fechaLimite,forma_pago:t.formaPago,enlace:t.enlace,tipo:t.tipo,cartel:t.cartel}}mapFromBackend(t){return{id:t.id,nombre:t.nombre,lugar:t.lugar,fechaEvento:t.fecha_evento,fechaFinEvento:t.fecha_fin_evento,fechaLimite:t.fecha_limite,formaPago:t.forma_pago,enlace:t.enlace,tipo:t.tipo,cartel:t.cartel}}static \u0275fac=function(e){return new(e||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};export{g as a};
