import{a as U}from"./chunk-2TF34DLE.js";import{a as F,c as z,e as A,m as j}from"./chunk-FS4DQBSW.js";import{a as I}from"./chunk-SZQNQJVS.js";import"./chunk-V4F4V7VE.js";import"./chunk-ZMUGLBPJ.js";import"./chunk-KMKEUFOK.js";import{g as E,h as S,i as N,j as V,l as T}from"./chunk-J4EIBAYN.js";import{$ as g,Ab as h,Ba as w,Bb as C,Cb as P,Ea as c,Fb as O,Gb as D,Ra as y,V as v,Wa as b,_ as s,fb as m,gb as n,hb as i,ib as k,la as f,mb as u,na as M,qb as p,rb as l,wb as a,xb as x}from"./chunk-WYX5KYRP.js";import"./chunk-7CGTOI24.js";function B(d,o){if(d&1){let e=u();n(0,"div",18)(1,"h2"),a(2),i(),n(3,"button",19),p("click",function(){s(e);let t=l(2);return g(t.toggleEditName())}),a(4,"\u270F\uFE0F"),i()()}if(d&2){let e=l().ngIf;c(2),x(e.displayName)}}function Y(d,o){if(d&1){let e=u();n(0,"div",20)(1,"input",21),P("ngModelChange",function(t){s(e);let _=l(2);return C(_.editedName,t)||(_.editedName=t),g(t)}),p("keyup.enter",function(){s(e);let t=l(2);return g(t.saveName())}),i(),n(2,"div",22)(3,"button",23),p("click",function(){s(e);let t=l(2);return g(t.saveName())}),a(4,"\u2705"),i(),n(5,"button",24),p("click",function(){s(e);let t=l(2);return g(t.toggleEditName())}),a(6,"\u274C"),i()()()}if(d&2){let e=l(2);c(),h("ngModel",e.editedName)}}function q(d,o){d&1&&(n(0,"div",25)(1,"p"),a(2,"A\xFAn no has a\xF1adido ning\xFAn perro."),i()())}function L(d,o){if(d&1){let e=u();n(0,"div",26)(1,"div",27),a(2,"\u{1F415}"),i(),n(3,"div",28)(4,"span",29),a(5),i()(),n(6,"button",30),p("click",function(){let t=s(e).$implicit,_=l(2);return g(_.deleteDog(t.id,t.name))}),a(7,"\u{1F5D1}\uFE0F"),i()()}if(d&2){let e=o.$implicit;c(5),x(e.name)}}function J(d,o){if(d&1){let e=u();n(0,"div",31),p("click",function(){s(e);let t=l(2);return g(t.closeDeleteModal())}),n(1,"div",32),p("click",function(t){return s(e),g(t.stopPropagation())}),n(2,"div",33)(3,"h3"),a(4,"\xBFJubilar a tu perrete? \u{1F622}"),i(),n(5,"button",34),p("click",function(){s(e);let t=l(2);return g(t.closeDeleteModal())}),a(6,"\xD7"),i()(),n(7,"div",35)(8,"p"),a(9," \xBFEst\xE1s seguro de que quieres jubilar a "),n(10,"strong"),a(11),i(),a(12," de tu perfil? "),i(),n(13,"p",36),a(14,"Esta acci\xF3n no se puede deshacer y perder\xE1s su historial."),i()(),n(15,"div",37)(16,"button",38),p("click",function(){s(e);let t=l(2);return g(t.closeDeleteModal())}),a(17,"Cancelar"),i(),n(18,"button",39),p("click",function(){s(e);let t=l(2);return g(t.confirmDelete())}),a(19," S\xED, Eliminar "),i()()()()}if(d&2){let e,r=l(2);c(11),x((e=r.dogToDelete())==null?null:e.name)}}function R(d,o){if(d&1){let e=u();n(0,"div",1)(1,"div",2),k(2,"img",3),n(3,"div",4)(4,"div",5),b(5,B,5,1,"div",6)(6,Y,7,1,"div",7),i(),n(7,"p"),a(8),i(),n(9,"span",8),a(10),O(11,"titlecase"),i()()(),n(12,"div",9)(13,"h3"),a(14,"\u{1F436} Mis Perretes"),i(),n(15,"p",10),a(16,"A\xF1ade aqu\xED a tus compa\xF1eros de Agility."),i(),n(17,"div",11)(18,"input",12),P("ngModelChange",function(t){s(e);let _=l();return C(_.newDogName,t)||(_.newDogName=t),g(t)}),p("keyup.enter",function(){s(e);let t=l();return g(t.addDog())}),i(),n(19,"button",13),p("click",function(){s(e);let t=l();return g(t.addDog())}),a(20," A\xF1adir Perro "),i()(),n(21,"div",14),b(22,q,3,0,"div",15)(23,L,8,1,"div",16),i()(),b(24,J,20,1,"div",17),i()}if(d&2){let e=o.ngIf,r=l();c(2),m("src",e.photoURL||"assets/default-user.png",w),c(3),m("ngIf",!r.isEditingName()),c(),m("ngIf",r.isEditingName()),c(2),x(e.email),c(),m("ngClass",e.role),c(),x(D(11,11,e.role)),c(8),h("ngModel",r.newDogName),c(),m("disabled",!r.newDogName().trim()),c(3),m("ngIf",r.dogs().length===0),c(),m("ngForOf",r.dogs()),c(),m("ngIf",r.deleteModalOpen())}}var W=class d{authService=v(I);dogService=v(U);newDogName=f("");dogs=this.dogService.getDogs();deleteModalOpen=f(!1);dogToDelete=f(null);isEditingName=f(!1);editedName=f("");constructor(){M(()=>{let o=this.authService.currentUserSignal();o&&this.dogService.subscribeToUserDogs(o.uid);let e=this.authService.userProfileSignal();e&&this.editedName.set(e.displayName)})}toggleEditName(){if(this.isEditingName.set(!this.isEditingName()),this.isEditingName()){let o=this.authService.userProfileSignal();o&&this.editedName.set(o.displayName)}}async saveName(){if(this.editedName().trim())try{await this.authService.updateDisplayName(this.editedName()),this.isEditingName.set(!1)}catch(o){console.error("Error updating name:",o),alert("Error al actualizar el nombre")}}async addDog(){if(!this.newDogName().trim())return;let o=this.authService.currentUserSignal();if(o)try{await this.dogService.addDog({userId:o.uid,name:this.newDogName(),createdAt:Date.now()}),this.newDogName.set("")}catch(e){console.error("Error adding dog:",e)}}deleteDog(o,e){this.dogToDelete.set({id:o,name:e}),this.deleteModalOpen.set(!0)}closeDeleteModal(){this.deleteModalOpen.set(!1),this.dogToDelete.set(null)}async confirmDelete(){let o=this.dogToDelete();o&&(await this.dogService.deleteDog(o.id),this.closeDeleteModal())}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=y({type:d,selectors:[["app-perfil"]],decls:1,vars:1,consts:[["class","perfil-container",4,"ngIf"],[1,"perfil-container"],[1,"profile-header"],["alt","Avatar","referrerpolicy","no-referrer",1,"profile-avatar",3,"src"],[1,"profile-info"],[1,"name-edit-container"],["class","name-display",4,"ngIf"],["class","name-input-group",4,"ngIf"],[1,"role-badge",3,"ngClass"],[1,"dogs-section"],[1,"section-desc"],[1,"add-dog-form"],["type","text","placeholder","Nombre de tu perro...",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-add",3,"click","disabled"],[1,"dogs-list"],["class","empty-state",4,"ngIf"],["class","dog-card",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"name-display"],["title","Editar nombre",1,"btn-icon-edit",3,"click"],[1,"name-input-group"],["type","text",1,"edit-name-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"edit-actions"],[1,"btn-check",3,"click"],[1,"btn-cancel-edit",3,"click"],[1,"empty-state"],[1,"dog-card"],[1,"dog-icon"],[1,"dog-info"],[1,"dog-name"],["title","Eliminar",1,"btn-delete",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content","glass-effect",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"note","warning"],[1,"modal-actions"],[1,"btn-cancel",3,"click"],[1,"btn-confirm","btn-delete-action",3,"click"]],template:function(e,r){e&1&&b(0,R,25,13,"div",0),e&2&&m("ngIf",r.authService.userProfileSignal())},dependencies:[T,E,S,N,j,F,z,A,V],styles:[".perfil-container[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:2rem;background-color:#fff;border-radius:12px;box-shadow:0 4px 6px #0000000d}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;padding-bottom:2rem;border-bottom:1px solid #eee;margin-bottom:2rem}.profile-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--accent-orange);flex-shrink:0}.profile-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:var(--primary-blue);word-break:break-word}.name-edit-container[_ngcontent-%COMP%]{margin-bottom:5px}.name-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.btn-icon-edit[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1rem;opacity:.5;transition:opacity .2s;padding:5px}.btn-icon-edit[_ngcontent-%COMP%]:hover{opacity:1}.name-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.edit-name-input[_ngcontent-%COMP%]{padding:6px 10px;border:1px solid var(--primary-blue);border-radius:6px;font-size:1.1rem;font-weight:700;color:#333;width:200px}.edit-actions[_ngcontent-%COMP%]{display:flex;gap:5px}.btn-check[_ngcontent-%COMP%], .btn-cancel-edit[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1.1rem;padding:4px;transition:transform .1s}.btn-check[_ngcontent-%COMP%]:hover, .btn-cancel-edit[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#666;word-break:break-all}.role-badge[_ngcontent-%COMP%]{display:inline-block;margin-top:8px;padding:2px 8px;border-radius:12px;font-size:.75rem;font-weight:600;background-color:#eee;color:#666;text-transform:uppercase}.role-badge.admin[_ngcontent-%COMP%]{background-color:#ffebee;color:#d32f2f}.role-badge.staff[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.role-badge.member[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.dogs-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333;font-size:1.5rem}.section-desc[_ngcontent-%COMP%]{color:#777;margin-bottom:1.5rem}.add-dog-form[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:2rem}.add-dog-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:12px 15px;border:1px solid #ddd;border-radius:6px;font-size:1rem;min-width:0}.btn-add[_ngcontent-%COMP%]{background-color:var(--primary-blue);color:#fff;border:none;padding:0 20px;border-radius:6px;cursor:pointer;font-weight:700;transition:background .2s;white-space:nowrap}.btn-add[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#004494}.btn-add[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.dogs-list[_ngcontent-%COMP%]{display:grid;gap:10px;grid-template-columns:repeat(auto-fill,minmax(100%,1fr))}.dog-card[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#f9f9f9;padding:15px;border-radius:8px;border:1px solid #eee;transition:transform .2s}.dog-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#ddd}.dog-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-right:15px;background-color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;box-shadow:0 2px 4px #0000000d;flex-shrink:0}.dog-info[_ngcontent-%COMP%]{flex:1;min-width:0}.dog-name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#333;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.btn-delete[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1.2rem;opacity:.6;transition:opacity .2s;padding:10px}.btn-delete[_ngcontent-%COMP%]:hover{opacity:1}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#999;font-style:italic;background-color:#f9f9f9;border-radius:8px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .3s ease}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:16px;width:90%;max-width:450px;box-shadow:0 20px 50px #0003;animation:_ngcontent-%COMP%_slideUp .3s ease;border:1px solid rgba(0,0,0,.1)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1.4rem}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#999;transition:color .2s}.close-btn[_ngcontent-%COMP%]:hover{color:#333}.modal-body[_ngcontent-%COMP%]{margin-bottom:2rem;color:#444;line-height:1.6;font-size:1.05rem}.note[_ngcontent-%COMP%]{display:block;margin-top:1rem;font-size:.9rem;font-style:italic;background-color:#fff1f2;padding:10px;border-radius:6px}.note.warning[_ngcontent-%COMP%]{color:#d32f2f;border-left:4px solid #d32f2f}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem}.btn-cancel[_ngcontent-%COMP%]{background:#f0f0f0;color:#666;border:none;padding:.8rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;transition:background .2s}.btn-cancel[_ngcontent-%COMP%]:hover{background:#e0e0e0}.btn-confirm[_ngcontent-%COMP%]{border:none;padding:.8rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;color:#fff;transition:transform .2s,background-color .2s}.btn-delete-action[_ngcontent-%COMP%]{background:#dc3545;box-shadow:0 4px 10px #dc35454d}.btn-delete-action[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:translateY(-2px);box-shadow:0 6px 15px #dc354566}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}@media(max-width:600px){.perfil-container[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem}.profile-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:15px}.profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px}.profile-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4rem}.add-dog-form[_ngcontent-%COMP%]{flex-direction:column}.btn-add[_ngcontent-%COMP%]{width:100%;padding:12px}.dogs-list[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{W as Perfil};
